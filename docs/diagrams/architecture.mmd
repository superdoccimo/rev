flowchart TB
    user[ブラウザ / クライアント]
    
    subgraph host [ホスト環境]
        direction TB
        nginx[Nginx リバースプロキシ<br/>コンテナ]
        
        subgraph assets [Certbot Assets]
            WWW[/certbot/www/<br/>ACME Webroot]
            CONF[/certbot/conf/<br/>LE アカウントと証明書]
        end
        
        app[上流アプリ<br/>ホスト or 他コンテナ]
    end

    user -->|HTTPS 443| nginx
    user -->|HTTP 80<br/>リダイレクト| nginx
    nginx -.-> WWW
    nginx -.-> CONF
    nginx -->|プロキシ<br/>HTTP/WS| app

    classDef userClass fill:#e1f5fe
    classDef nginxClass fill:#f3e5f5
    classDef appClass fill:#e8f5e8
    classDef assetClass fill:#fff3e0

    class user userClass
    class nginx nginxClass
    class app appClass
    class WWW,CONF assetClass

